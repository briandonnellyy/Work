<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>Film DataBase Assignment</title>
    <script src="https://code.jquery.com/jquery-3.2.1.slim.min.js" integrity="sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.11.0/umd/popper.min.js" integrity="sha384-b/U6ypiBEHpOf/4+1nzFpr53nxSS+GLCkfwBdFNTxtclqqenISfwAzpKaMNFNmj4" crossorigin="anonymous"></script>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-beta/css/bootstrap.min.css" integrity="sha384-/Y6pD6FV/Vv2HJnA6t+vslU6fwYXjCFtcEpHbNJ0lyAFsXTsjBbfaDjzALeQsN6M" crossorigin="anonymous">
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-beta/js/bootstrap.min.js" integrity="sha384-h0AbiXch4ZDo7tp9hKZ4TsHbi047NrKGLO3SEJAg45jXxnGIfYzk4Si90RDIqNm1" crossorigin="anonymous"></script>
    <style>
        .border_shadow {
            -webkit-box-shadow: 0px 0px 20px #888;
            padding: 5px 5px 5px 15px;
            width: 300px;
        }
        
        #everythingNoHeader {
            margin: auto;
            width: 60%;
            padding: 10px;
        }
        
        #header {
            width: 100%;
            text-align: center;
            margin: auto;
        }
        
        #desc1 {
            margin: auto;
            text-align: center;
            color: #212121;
        }
        
        #desc2 {
            margin: auto;
            text-align: center;
            color: #212121;
        }
        
        input[type=text],
        select,
        input[type=date],
        input[type=number] {
            width: 100%;
            padding: 12px 20px;
            margin: 8px 0;
            display: inline-block;
            border: 1px solid #ccc;
            border-radius: 4px;
            box-sizing: border-box;
        }
        
        button {
            width: 100%;
            background-color: #FF9800;
            color: white;
            padding: 14px 20px;
            margin: 8px 0;
            border: none;
            border-radius: 4px;
            cursor: pointer;
        }
        
        button:hover {
            background-color: #F57C00
        }
    </style>
</head>

<body>
    <div id="page">

        <div id="header" class="border_shadow">
            <h1> <img alt="FilmDB" class="img-responsive" src="http://www.guhu.ca/wp-content/uploads/2016/01/film-reel.jpg" WIDTH=100 HEIGHT=100 /> Film DB</h1>
        </div>
        <div id="everythingNoHeader">
            <div id="desc1" style="display: block">
                <p><strong>A client side film database made with JavaScript allowing the user to create, read, update and delete films. Click "Add" to start.</strong></p>

            </div>
            <div id="desc2" style="display: none">
                <p><strong>A client side film database made with JavaScript allowing the user to create, read, update and delete films.</strong></p>
            </div>

            <div id="startPagination" style="display: block">
                <button onclick="window.id = 1; start('startPagination','createUpdate','desc1','desc2','doneAdding','addAfterStart')">Add</button>
            </div>
            <div id="addAfterStart" style="display: none">
                <button onclick="start('startPagination','createUpdate','desc1','desc2','doneAdding','addAfterStart')">Add</button>
            </div>

            <div id="createUpdate" style="display: none">
                <strong>ID</strong> <input type="number" id="inputId" required><br/> <strong>Film</strong> <input type="text" id="inputName" required><br/> <strong>Genre</strong> <select id="inputGenre" required>
                    <option value="Action">Action</option>
                    <option value="Adventure">Adventure</option>
                    <option value="Comedy">Comedy</option>
                    <option value="Crime">Crime</option>                    <option value="action">Action</option>
                    <option value="Drama">Drama</option>
                    <option value="Horror">Horror</option>
                    <option value="Sci-fi">Sci-fi</option>
                    <option value="Thriller">Thriller</option>
                  </select><br/> <strong>Date Published</strong> <input type="date" id="inputDate" required><br/>
                <button id="updateCreate" onclick="validateFilm()" class="btn-success">Create</button>


            </div>
            <div id="doneAdding" style="display: none" onclick="done('startPagination','createUpdate','desc1','desc2','doneAdding','addAfterStart')"><button id="doneAdd" class="btn-success">Done</button></div>

            <div id="database" style="display: block">
                <table id="filmList" class="table">
                    <tr>
                        <th>ID</th>
                        <th>Film</th>
                        <th>Genre</th>
                        <th>Date Published</th>
                        <th>Delete</th>
                        <th>Update</th>
                        <th>Trailer</th>
                    </tr>
                </table>
            </div>

            <div style="display: none" id="deleteTemplate">
                <button onclick="deleteFilm(this)" class="btn-danger">Delete</button>
            </div>

            <div style="display: none" id="updateTemplate">
                <button onclick="update(this); start('startPagination','createUpdate','desc1','desc2','doneAdding','addAfterStart')" class="btn-primary">Update</button>
            </div>
            <div style="display: none" id="trailerTemplate">
                <button onclick="trailerSearch(this, 'https://www.youtube.com/results?search_query=')" );>Trailer</button>
            </div>
        </div>
    </div>

    <script>
        function trailerSearch(thisElem, url) {
            var rowUpdate = thisElem.closest("tr");
            var rowId = rowUpdate.getAttribute("id");
            var trailerSpace = '%20trailer';
            var film = {};
            film.name = rowUpdate.getElementsByTagName("td")[1].firstChild.nodeValue;
            window.open(url + film.name + trailerSpace, '_blank');
        }

        function validateFilm() {
            var input, text;
            input = document.getElementById("inputId").value;
            if (isNaN(input) || input < 1) {
                alert("Please input a film.");
            } else {
                createfilm();
            }
        }

        function createfilm() {
            var idElem = document.getElementById("inputId");
            var nameElem = document.getElementById("inputName");
            var genreElem = document.getElementById("inputGenre");
            var dateElem = document.getElementById("inputDate");
            var film = {};
            film.id = idElem.value;
            film.name = nameElem.value;
            film.genre = genreElem.value;
            film.date = dateElem.value;
            idElem.value = "";
            nameElem.value = "";
            genreElem.value = "";
            dateElem.value = "";
            insertFilmIntoTable(film);
        }

        function insertFilmIntoTable(film) {
            var filmList = document.getElementById("filmList");
            var rowCreate = filmList.insertRow(-1);
            var cell = rowCreate.insertCell(0);
            rowCreate.id = id;
            id++;
            cell.innerHTML = film.id;
            cell = rowCreate.insertCell(1);
            cell.innerHTML = film.name;
            cell = rowCreate.insertCell(2);
            cell.innerHTML = film.genre;
            cell = rowCreate.insertCell(3);
            cell.innerHTML = film.date;
            cell = rowCreate.insertCell(4);
            var deleteText = document.getElementById("deleteTemplate").innerHTML;
            cell.innerHTML = deleteText;
            cell = rowCreate.insertCell(5);
            var updateText = document.getElementById("updateTemplate").innerHTML;
            cell.innerHTML = updateText;
            cell = rowCreate.insertCell(6);
            var trailerText = document.getElementById("trailerTemplate").innerHTML;
            cell.innerHTML = trailerText;
            if (id > 1) {
                doneAdd.style.display = "block";
            } else {}
        }

        function deleteFilm(thisElem) {
            var rowDelete = thisElem.closest("tr");
            rowDelete.parentNode.removeChild(rowDelete);
        }

        function update(buttonElem) {
            var rowUpdate = buttonElem.closest("tr");
            var rowId = rowUpdate.getAttribute("id");
            var film = {};
            film.id = rowUpdate.getElementsByTagName("td")[0].firstChild.nodeValue;
            film.name = rowUpdate.getElementsByTagName("td")[1].firstChild.nodeValue;
            film.genre = rowUpdate.getElementsByTagName("td")[2].firstChild.nodeValue;
            film.date = rowUpdate.getElementsByTagName("td")[3].firstChild.nodeValue;
            addUpdated(film, rowId);

            function addUpdated(film, rowId) {
                document.getElementById("inputId").value = film.id;
                document.getElementById("inputName").value = film.name;
                document.getElementById("inputGenre").value = film.genre;
                document.getElementById("inputDate").value = film.date;
                var button = document.getElementById("updateCreate");
                button.innerHTML = "Update";
                button.onclick = function() {
                    doneAdd.style.display = "block";
                    var film = {};
                    film.id = document.getElementById("inputId").value;
                    film.name = document.getElementById("inputName").value;
                    film.genre = document.getElementById("inputGenre").value;
                    film.date = document.getElementById("inputDate").value;
                    updateRow(film, rowId);
                    button.innerHTML = "Create";
                    button.onclick = function() {
                        doneAdd.style.display = "block";
                        validateFilm()
                    }
                }
            }
        }

        function updateRow(film, rowId) {
            var rowUpdate2 = document.getElementById(rowId);
            rowUpdate2.getElementsByTagName("td")[0].innerHTML = film.id;
            rowUpdate2.getElementsByTagName("td")[1].innerHTML = film.name;
            rowUpdate2.getElementsByTagName("td")[2].innerHTML = film.genre;
            rowUpdate2.getElementsByTagName("td")[3].innerHTML = film.date;
        }

        function start(startId, addId, desc1, desc2, doneAdding, addAfterStart) {
            var addAfter = document.getElementById(addAfterStart);
            window.doneAdd = document.getElementById(doneAdding);
            var descNow = document.getElementById(desc1);
            var descNext = document.getElementById(desc2);
            var startDiv = document.getElementById(startId);
            var addDiv = document.getElementById(addId);
            addAfter.style.display = "none";
            doneAdd.style.display = "none";
            startDiv.style.display = "none";
            addDiv.style.display = "block";
            descNow.style.display = "none";
            descNext.style.display = "block";
        }

        function done(startId, addId, desc1, desc2, doneAdding, addAfterStart) {
            var addAfter = document.getElementById(addAfterStart);
            var doneAdd = document.getElementById(doneAdding);
            var descNow = document.getElementById(desc1);
            var descNext = document.getElementById(desc2);
            var startDiv = document.getElementById(startId);
            var addDiv = document.getElementById(addId);
            addAfter.style.display = "block";
            doneAdd.style.display = "none";
            startDiv.style.display = "none";
            addDiv.style.display = "none";
            descNow.style.display = "none";
            descNext.style.display = "block";
        }
    </script>
</body>

</html>